{% extends "base.html" %}
                      
{% block title %}{{ item.name }}{% endblock %}

{% block extra_head %}
<style>
h1 {
  font-size: 3em;
  margin: 0;
}
h2 {
  font-size: 1.5em;
  color: #666;
}
h3 {
  margin: 0;
  padding-bottom: 1em;
}
div.info {
  width: 750px;
  clear: both;
  float: left;
}
div.secondary {
  width: 300px;
  float: left;
}

div.tertiary {
  width: 388px;
  float: left;
}
div.polaroid {
  border: 2px solid #666;
  background-color: #ccc;
  margin: 0;
  padding: 0;
}
div.polaroid img {
  display: block;
  border: none;
}
div.polaroid p {
  margin: 0;
  padding: 2px;
}
div.text {
  padding-left: 1em;
  float: left;
  width: 300px;
}
ul, li {
  list-style-type: none;
  margin: 0;
  padding: 0;
}
ul {
  margin-bottom: 1em;
}
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js" type="text/javascript"></script>
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=false&amp;key=ABQIAAAAyYu8a7AdbfUctK3zwwu_2hQCULP4XOMyhPd8d_NrQQEO8sT8XBQQ8wbEZJ22JhSZQuxIzOKGAVxvKw" type="text/javascript"></script>
<script type="text/javascript">
jQuery(function($) {
  var div = $('.map-goes-here');
  if (div.length) {
    div.width(600).height(300).css('clear', 'both');
    var map = new GMap2(div[0]);
    map.setCenter(new GLatLng(43.8, -37.3), 1);
    var geocoder = new GClientGeocoder();
    var bounds = new GLatLngBounds();
    /* Now pull in the places */
    $('ul.places span').each(function() {
      var span = $(this);
      geocoder.getLatLng(span.text(), function(point) {
        var marker = new GMarker(point);
        map.addOverlay(marker);
        GEvent.addListener(marker, "click", function() {
          marker.openInfoWindowHtml(
            span.parent().html().replace(' - ', '<br>')
          );
        });
        bounds.extend(point);
        map.setCenter(
          bounds.getCenter(), Math.min(
            6, (map.getBoundsZoomLevel(bounds) - 1)
          )
        );
      });
    });
  }
});
</script>
{% endblock %}

{% block content %}
<h1>{{ item.name }}</h1>
<h2>{{ item.headline|default:"" }}</h2>

<div class="info">
  <div class="tertiary">
    {% if item.image %}
    <div class="polaroid">
      <img src="{{ item.image_small }}">
      <p><strong>Date:</strong> {{ item.interpretative_date }}</p>
    </div>
    {% else %}
    <strong>Date:</strong> {{ item.interpretative_date }}<br>
    {% endif %}
    {% if item.materials.all %}
    <strong>Made of:</strong> 
      {% for material in item.materials.all %}
      {{ material.component }}: {{ material.description }}
      {% if not forloop.last %}, {% endif %}
      {% endfor %}
      <br>
    {% endif %}
    {% if item.measurements.all %}
    <strong>Measurements:</strong> 
      {% for measurement in item.measurements.all %}
      {{ measurement.description }}
      {% if not forloop.last %}, {% endif %}
      {% endfor %}
      <br>
    {% endif %}
    <strong>Credit:</strong> {{ item.credit }}<br>
  </div>
  <div class="text">{{ item.text }}</div>
</div>

<div class="secondary">
{% if item.people %}
  <h3>People and organisations</h3>
  <ul>
  {% for p in item.people %}
  <li><a href="{{ p.0.get_absolute_url }}">{{ p.0 }}</a> - {{ p.1|join:", " }}</li>
  {% endfor %}
  </ul>
{% endif %}

{% if item.celestial_bodies.all %}
  <h3>Celestial bodies</h3>
  <ul>
  {% for body in item.celestial_bodies.all %}
  <li><a href="{{ body.get_absolute_url }}">{{ body }}</a></li>
  {% endfor %}
  </ul>
{% endif %}
</div>

{% if item.places %}
<h3>Places</h3>
<ul class="places">
  {% for p in item.places %}
    <li><span>{{ p.0 }}</span> - <strong>{{ p.1|join:", " }}</strong></li>
  {% endfor %}
</ul>
<div class="map-goes-here"></div>
{% endif %}

{% endblock %}
